WARNING::lambda1_stud not found in config file
WARNING::lambda2_stud not found in config file
2018-05-15 00:32:25.531057: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-15 00:32:26.643381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: GeForce GTX TITAN X major: 5 minor: 2 memoryClockRate(GHz): 1.076
pciBusID: 0000:04:00.0
totalMemory: 11.92GiB freeMemory: 11.80GiB
2018-05-15 00:32:26.643580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/mnist_classification/model-20000
2018-05-15 00:32:29.737686: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
INFO::h3.haowen6.biglearning.orca.pdl.cmu.edu
INFO::[DEFAULT]
INFO::[env]
INFO::exp_dir:: ~/haowen/GitHub/autoLoss
INFO::data_dir:: ~/haowen/GitHub/autoLoss/Data
INFO::model_dir:: /datasets/BigLearning/haowen/autoLoss/saved_models
INFO::[data]
INFO::train_data_file:: cls_transfer02/train.npy
INFO::valid_data_file:: cls_transfer02/valid.npy
INFO::test_data_file:: cls_transfer02/test.npy
INFO::num_sample_train:: 200
INFO::num_sample_valid:: 1000
INFO::num_sample_test:: 1000
INFO::mean_noise:: 0
INFO::var_noise:: 4
INFO::random_seed:: 100
INFO::[stud]
INFO::student_model_name:: cls
INFO::batch_size:: 200
INFO::dim_input_stud:: 32
INFO::dim_hidden_stud:: 32
INFO::dim_output_stud:: 2
INFO::lr_stud:: 0.1
INFO::valid_frequency_stud:: 10
INFO::max_endurance_stud:: 50
INFO::max_training_step:: 20000
INFO::lambda1_stud:: 0.1
INFO::lambda2_stud:: 0.0003
INFO::[train]
INFO::[evaluate]
INFO::[rl]
INFO::controller_model_name:: linear_logits_clipping
INFO::num_pre_loss:: 2
INFO::dim_state_rl:: 7
INFO::dim_hidden_rl:: 16
INFO::dim_action_rl:: 2
INFO::lr_rl:: 0.1
INFO::lr_decay_rl:: 1
INFO::total_episodes:: 401
INFO::update_frequency:: 1
INFO::save_frequency:: 50
INFO::reward_baseline_decay:: 0.9
INFO::reward_c:: 100
INFO::reward_step_rl:: 0.1
INFO::reward_max_value:: 2
INFO::explore_rate_decay_rl:: 100
INFO::explore_rate_rl:: 0
INFO::max_endurance_rl:: 50
INFO::logit_clipping_c:: 2
INFO::exp_name: h3-haowen6_05-15-06-32
2018-05-15 00:32:29.761632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
2018-05-15 00:32:29.835738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
/users/hzhang2/haowen/miniconda3/envs/py35_tf/lib/python3.5/site-packages/tensorflow/python/ops/gradients_impl.py:96: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
INFO::TEST
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8939999938011169
INFO::test_acc: 0.8899999856948853
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.9039999842643738
INFO::test_acc: 0.8920000195503235
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.9010000228881836
INFO::test_acc: 0.8970000147819519
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.9020000100135803
INFO::test_acc: 0.8949999809265137
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.890999972820282
INFO::test_acc: 0.8809999823570251
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8949999809265137
INFO::test_acc: 0.8880000114440918
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8949999809265137
INFO::test_acc: 0.8859999775886536
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8930000066757202
INFO::test_acc: 0.8899999856948853
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8939999938011169
INFO::test_acc: 0.8930000066757202
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8949999809265137
INFO::test_acc: 0.8830000162124634
INFO::[0.89, 0.892, 0.897, 0.895, 0.881, 0.888, 0.886, 0.89, 0.893, 0.883]
INFO::0.8895
INFO::2.3450035e-05
init_mnist_model
Extracting /datasets/BigLearning/haowen/mnist/train-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/train-labels-idx1-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-labels-idx1-ubyte.gz
Load 55000 samples.
Extracting /datasets/BigLearning/haowen/mnist/train-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/train-labels-idx1-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-labels-idx1-ubyte.gz
Load 10000 samples.
load 200 samples.
load 1000 samples.
load 1000 samples.
ce loss and l1 loss
lambda1: 0.1
WARNING::lambda1_stud not found in config file
WARNING::lambda2_stud not found in config file
2018-05-15 00:35:30.201488: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-15 00:35:31.293322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: GeForce GTX TITAN X major: 5 minor: 2 memoryClockRate(GHz): 1.076
pciBusID: 0000:04:00.0
totalMemory: 11.92GiB freeMemory: 11.80GiB
2018-05-15 00:35:31.293361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/mnist_classification/model-20000
2018-05-15 00:35:34.103884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
INFO::h3.haowen6.biglearning.orca.pdl.cmu.edu
INFO::[DEFAULT]
INFO::[env]
INFO::exp_dir:: ~/haowen/GitHub/autoLoss
INFO::data_dir:: ~/haowen/GitHub/autoLoss/Data
INFO::model_dir:: /datasets/BigLearning/haowen/autoLoss/saved_models
INFO::[data]
INFO::train_data_file:: cls_transfer03/train.npy
INFO::valid_data_file:: cls_transfer03/valid.npy
INFO::test_data_file:: cls_transfer03/test.npy
INFO::num_sample_train:: 200
INFO::num_sample_valid:: 1000
INFO::num_sample_test:: 1000
INFO::mean_noise:: 0
INFO::var_noise:: 4
INFO::random_seed:: 100
INFO::[stud]
INFO::student_model_name:: cls
INFO::batch_size:: 200
INFO::dim_input_stud:: 32
INFO::dim_hidden_stud:: 32
INFO::dim_output_stud:: 2
INFO::lr_stud:: 0.1
INFO::valid_frequency_stud:: 10
INFO::max_endurance_stud:: 50
INFO::max_training_step:: 20000
INFO::lambda1_stud:: 0.1
INFO::lambda2_stud:: 0.0003
INFO::[train]
INFO::[evaluate]
INFO::[rl]
INFO::controller_model_name:: linear_logits_clipping
INFO::num_pre_loss:: 2
INFO::dim_state_rl:: 7
INFO::dim_hidden_rl:: 16
INFO::dim_action_rl:: 2
INFO::lr_rl:: 0.1
INFO::lr_decay_rl:: 1
INFO::total_episodes:: 401
INFO::update_frequency:: 1
INFO::save_frequency:: 50
INFO::reward_baseline_decay:: 0.9
INFO::reward_c:: 100
INFO::reward_step_rl:: 0.1
INFO::reward_max_value:: 2
INFO::explore_rate_decay_rl:: 100
INFO::explore_rate_rl:: 0
INFO::max_endurance_rl:: 50
INFO::logit_clipping_c:: 2
INFO::exp_name: h3-haowen6_05-15-06-35
2018-05-15 00:35:34.124705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
2018-05-15 00:35:34.196164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
/users/hzhang2/haowen/miniconda3/envs/py35_tf/lib/python3.5/site-packages/tensorflow/python/ops/gradients_impl.py:96: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
INFO::TEST
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.9079999923706055
INFO::test_acc: 0.890999972820282
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8930000066757202
INFO::test_acc: 0.8870000243186951
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8949999809265137
INFO::test_acc: 0.8920000195503235
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8980000019073486
INFO::test_acc: 0.8899999856948853
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8960000276565552
INFO::test_acc: 0.8930000066757202
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8939999938011169
INFO::test_acc: 0.8809999823570251
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8980000019073486
INFO::test_acc: 0.8920000195503235
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8960000276565552
INFO::test_acc: 0.890999972820282
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8930000066757202
INFO::test_acc: 0.8889999985694885
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-13-04-30_ctrl/model-400
INFO::valid_acc: 0.8999999761581421
INFO::test_acc: 0.8970000147819519
INFO::[0.891, 0.887, 0.892, 0.89, 0.893, 0.881, 0.892, 0.891, 0.889, 0.897]
INFO::0.8903
INFO::1.5810048e-05
init_mnist_model
Extracting /datasets/BigLearning/haowen/mnist/train-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/train-labels-idx1-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-labels-idx1-ubyte.gz
Load 55000 samples.
Extracting /datasets/BigLearning/haowen/mnist/train-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/train-labels-idx1-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-labels-idx1-ubyte.gz
Load 10000 samples.
load 200 samples.
load 1000 samples.
load 1000 samples.
ce loss and l1 loss
lambda1: 0.1
