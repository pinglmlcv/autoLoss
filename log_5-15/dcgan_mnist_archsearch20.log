WARNING::lambda1_stud not found in config file
WARNING::lambda2_stud not found in config file
2018-05-15 14:05:51.274551: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-15 14:05:52.361843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: GeForce GTX TITAN X major: 5 minor: 2 memoryClockRate(GHz): 1.076
pciBusID: 0000:04:00.0
totalMemory: 11.92GiB freeMemory: 11.80GiB
2018-05-15 14:05:52.361884: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/mnist_classification/model-20000
2018-05-15 14:05:55.040546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
INFO::h5.haowen6.biglearning.orca.pdl.cmu.edu
WARNING::lambda1_stud not found in config file
WARNING::lambda2_stud not found in config file
INFO::[DEFAULT]
INFO::[env]
INFO::exp_dir:: ~/haowen/GitHub/autoLoss
INFO::data_dir:: /datasets/BigLearning/haowen/mnist
INFO::model_dir:: /datasets/BigLearning/haowen/autoLoss/saved_models
INFO::save_images_dir:: /datasets/BigLearning/haowen/autoLoss/saved_images
INFO::[data]
INFO::[stud]
INFO::student_model_name:: gan
INFO::batch_size:: 128
INFO::lr_stud:: 0.0002
INFO::beta1:: 0.5
INFO::beta2:: 0.999
INFO::valid_frequency_stud:: 500
INFO::print_frequency_stud:: 2000
INFO::max_endurance_stud:: 10
INFO::max_training_step:: 200000
INFO::stop_strategy_stud:: exceeding_endurance
INFO::[gan]
INFO::dim_z:: 128
INFO::dim_x:: 784
INFO::dim_c:: 64
INFO::disc_iters:: 1
INFO::gen_iters:: 1
INFO::inps_threshold:: 6.3
INFO::inps_batches:: 200
INFO::inps_splits:: 5
INFO::[evaluate]
INFO::[rl]
INFO::controller_model_name:: linear_logits_clipping
INFO::logit_clipping_c:: 2
INFO::dim_state_rl:: 5
INFO::dim_hidden_rl:: 16
INFO::dim_action_rl:: 2
INFO::lr_rl:: 2
INFO::lr_decay_rl:: 1
INFO::total_episodes:: 1000
INFO::update_frequency:: 1
INFO::save_frequency:: 100
INFO::inps_baseline_decay:: 0.8
INFO::reward_c:: 10
INFO::reward_step_rl:: 0.1
INFO::reward_max_value:: 20
INFO::explore_rate_decay_rl:: 100
INFO::explore_rate_rl:: 0
INFO::max_endurance_rl:: 50
INFO::state_decay:: 0.9
INFO::metric_decay:: 0.8
INFO::exp_name: h5-haowen6_05-15-20-05
2018-05-15 14:05:55.059653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
/users/hzhang2/haowen/miniconda3/envs/py35_tf/lib/python3.5/site-packages/tensorflow/python/ops/gradients_impl.py:96: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
INFO::architecture:
INFO::activation_D: tanh
INFO::activation_G: leakyRelu
INFO::batchnorm_D: False
INFO::batchnorm_G: False
INFO::depth_D: 2
INFO::depth_G: 2
INFO::dim_c_D: 128
INFO::dim_c_G: 128
INFO::dim_z: 64
2018-05-15 14:05:55.126694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
INFO::BASELINE
INFO::========Step0========
INFO::0
INFO::(1.0196507, 0.00030715973)
INFO::inps_baseline: 1.0196506977081299
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::gen_cost: 0.6694103479385376
INFO::disc_cost fake: 0.7174913287162781, real: 0.513931393623352
INFO::========Step500========
INFO::0
INFO::(1.2753174, 0.004314407)
INFO::inps_baseline: 1.070784044265747
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step1000========
INFO::0
INFO::(1.3375708, 0.0053634215)
INFO::inps_baseline: 1.1241413927078248
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step1500========
INFO::0
INFO::(1.4213197, 0.012188866)
INFO::inps_baseline: 1.1835770587921142
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step2000========
INFO::0
INFO::(1.4849372, 0.009252552)
INFO::inps_baseline: 1.2438490852355955
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::gen_cost: 0.6641334295272827
INFO::disc_cost fake: 0.728487491607666, real: 0.6008923053741455
INFO::========Step2500========
INFO::0
INFO::(1.4269905, 0.0041175215)
INFO::inps_baseline: 1.2804773699951169
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step3000========
INFO::0
INFO::(2.4167247, 0.016050065)
INFO::inps_baseline: 1.507726832366943
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step3500========
INFO::0
INFO::(4.4643264, 0.023453292)
INFO::inps_baseline: 2.0990467422302244
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step4000========
INFO::0
INFO::(4.410903, 0.048739873)
INFO::inps_baseline: 2.5614179891821287
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::gen_cost: 0.8253073692321777
INFO::disc_cost fake: 0.6165134310722351, real: 0.5349641442298889
INFO::========Step4500========
INFO::0
INFO::(4.655073, 0.04873107)
INFO::inps_baseline: 2.9801490245244135
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step5000========
INFO::0
INFO::(5.872089, 0.034503736)
INFO::inps_baseline: 3.558537001449365
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step5500========
INFO::0
INFO::(5.404445, 0.04374763)
INFO::inps_baseline: 3.927718635430732
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step6000========
INFO::0
INFO::(5.910694, 0.04111674)
INFO::inps_baseline: 4.324313732807476
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::gen_cost: 1.1163268089294434
INFO::disc_cost fake: 0.455596387386322, real: 0.7394805550575256
INFO::========Step6500========
INFO::0
INFO::(6.6441584, 0.025319584)
INFO::inps_baseline: 4.788282658914438
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step7000========
INFO::0
INFO::(6.7237854, 0.04553051)
INFO::inps_baseline: 5.175383207209675
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step7500========
INFO::0
INFO::(6.717215, 0.03479583)
INFO::inps_baseline: 5.4837495780052885
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step8000========
INFO::0
INFO::(7.0616317, 0.033889852)
INFO::inps_baseline: 5.799325998311214
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::gen_cost: 1.0593936443328857
INFO::disc_cost fake: 0.5046870708465576, real: 0.3812863826751709
INFO::========Step8500========
INFO::0
INFO::(7.167353, 0.019537484)
INFO::inps_baseline: 6.072931429294723
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step9000========
INFO::0
INFO::(7.344327, 0.04770261)
INFO::inps_baseline: 6.327210538028064
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step9500========
INFO::0
INFO::(7.415071, 0.05481758)
INFO::inps_baseline: 6.544782632540371
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step10000========
INFO::0
INFO::(7.498689, 0.07027653)
INFO::inps_baseline: 6.735563940962717
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::gen_cost: 1.720078945159912
INFO::disc_cost fake: 0.2761823534965515, real: 0.5632333755493164
INFO::========Step10500========
INFO::0
INFO::(7.4790573, 0.047449384)
INFO::inps_baseline: 6.884262615172517
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step11000========
INFO::0
INFO::(7.417897, 0.023877721)
INFO::inps_baseline: 6.9909895370232675
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step11500========
INFO::0
INFO::(7.4946647, 0.024142146)
INFO::inps_baseline: 7.091724563425987
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step12000========
INFO::0
INFO::(7.4632974, 0.04738222)
INFO::inps_baseline: 7.166039124159979
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::gen_cost: 1.7381643056869507
INFO::disc_cost fake: 0.2808915972709656, real: 0.5294879078865051
INFO::========Step12500========
INFO::0
INFO::(7.431695, 0.05787343)
INFO::inps_baseline: 7.21917029621519
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step13000========
INFO::0
INFO::(7.458106, 0.04299352)
INFO::inps_baseline: 7.2669574451630705
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step13500========
INFO::0
INFO::(7.3084474, 0.012466246)
INFO::inps_baseline: 7.2752554283289435
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::========Step14000========
INFO::0
INFO::(7.350287, 0.046748556)
INFO::inps_baseline: 7.290261734783516
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::gen_cost: 0.7927237749099731
INFO::disc_cost fake: 0.8911926746368408, real: 0.1300407350063324
INFO::========Step14500========
INFO::0
INFO::(7.256736, 0.078798786)
INFO::inps_baseline: 7.283556548166168
INFO::========Step15000========
INFO::1
INFO::(7.2752657, 0.059677534)
INFO::inps_baseline: 7.281898377265845
INFO::========Step15500========
INFO::2
INFO::(7.2669196, 0.024865026)
INFO::inps_baseline: 7.2789026243895805
INFO::========Step16000========
INFO::3
INFO::(7.16828, 0.02691234)
INFO::inps_baseline: 7.2567781244445255
INFO::gen_cost: 1.7799361944198608
INFO::disc_cost fake: 0.3008986711502075, real: 0.29011064767837524
INFO::========Step16500========
INFO::4
INFO::(7.171359, 0.045546494)
INFO::inps_baseline: 7.239694311994586
INFO::========Step17000========
INFO::5
INFO::(7.0276275, 0.07856063)
INFO::inps_baseline: 7.197280943217495
INFO::========Step17500========
INFO::6
INFO::(7.0724998, 0.022643037)
INFO::inps_baseline: 7.172324704982932
INFO::========Step18000========
INFO::7
INFO::(6.957036, 0.07338742)
INFO::inps_baseline: 7.129266967660662
INFO::gen_cost: 1.8873600959777832
INFO::disc_cost fake: 0.278125524520874, real: 0.19041487574577332
INFO::========Step18500========
INFO::8
INFO::(7.0378113, 0.040649496)
INFO::inps_baseline: 7.110975829987905
INFO::========Step19000========
INFO::9
INFO::(6.8343215, 0.05847414)
INFO::inps_baseline: 7.055644963764494
INFO::========Step19500========
INFO::10
INFO::(6.7860246, 0.054711018)
INFO::inps_baseline: 7.001720885104613
INFO::best_inps: 7.290261734783516
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model-14000
INFO::inps_baseline: (7.3706484, 0.006757728)
INFO::[(7.3706484, 0.006757728)]
INFO::TEST
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h2-haowen6_05-13-20-21_ctrl/model-20
INFO::step: 500, new best result: 1.08893883228302
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 1000, new best result: 1.1129358768463136
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 1500, new best result: 1.2011464405059815
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 2000, new best result: 1.3069991245269776
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::----step2000----
INFO::inception_score: (1.7304099, 0.009186366)
INFO::inps_baseline: 1.3069991245269776
INFO::step: 2500, new best result: 1.506079274368286
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 3000, new best result: 1.6633228921508787
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 3500, new best result: 1.7715368480377196
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 4000, new best result: 1.8856395412200926
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::----step4000----
INFO::inception_score: (2.3420503, 0.00915279)
INFO::inps_baseline: 1.8856395412200926
INFO::step: 4500, new best result: 2.0354400578112792
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 5000, new best result: 2.1846317055202635
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 5500, new best result: 2.210997390935986
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 6000, new best result: 2.330287161024546
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::----step6000----
INFO::inception_score: (2.8074462, 0.02220209)
INFO::inps_baseline: 2.330287161024546
INFO::step: 6500, new best result: 2.4437820454852863
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 7000, new best result: 2.5284667126669156
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 7500, new best result: 2.606757649766101
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 8000, new best result: 2.70820647000209
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::----step8000----
INFO::inception_score: (3.1140018, 0.025139555)
INFO::inps_baseline: 2.70820647000209
INFO::step: 8500, new best result: 2.785289140692834
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 9000, new best result: 2.869344975273994
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 9500, new best result: 2.89220158713753
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 10000, new best result: 2.988312518260439
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::----step10000----
INFO::inception_score: (3.3727562, 0.021866325)
INFO::inps_baseline: 2.988312518260439
INFO::step: 10500, new best result: 3.098722915380446
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 11000, new best result: 3.234067806028722
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::step: 11500, new best result: 3.3290271825976356
INFO::Save model at /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model
INFO::----step12000----
INFO::inception_score: (3.139769, 0.01802664)
INFO::inps_baseline: 3.2911755615383136
INFO::----step14000----
INFO::inception_score: (2.846106, 0.013381982)
INFO::inps_baseline: 3.0570401231957907
INFO::----step16000----
INFO::inception_score: (2.9812665, 0.010267869)
INFO::inps_baseline: 2.92768696896417
INFO::Loading pretrained model from: /datasets/BigLearning/haowen/autoLoss/saved_models/h5-haowen6_05-15-20-05_gan/model-11500
INFO::inps_test: (3.7202568, 0.0060497774)
INFO::[(3.7202568, 0.0060497774)]
init_mnist_model
Extracting /datasets/BigLearning/haowen/mnist/train-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/train-labels-idx1-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-labels-idx1-ubyte.gz
Load 55000 samples.
Extracting /datasets/BigLearning/haowen/mnist/train-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/train-labels-idx1-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-labels-idx1-ubyte.gz
Load 10000 samples.
Extracting /datasets/BigLearning/haowen/mnist/train-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/train-labels-idx1-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-labels-idx1-ubyte.gz
Load 55000 samples.
Extracting /datasets/BigLearning/haowen/mnist/train-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/train-labels-idx1-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-images-idx3-ubyte.gz
Extracting /datasets/BigLearning/haowen/mnist/t10k-labels-idx1-ubyte.gz
Load 10000 samples.
