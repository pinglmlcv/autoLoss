2018-05-05 23:31:21.909115: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-05-05 23:31:22.814507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: GeForce GTX TITAN X major: 5 minor: 2 memoryClockRate(GHz): 1.076
pciBusID: 0000:04:00.0
totalMemory: 11.92GiB freeMemory: 11.80GiB
2018-05-05 23:31:22.814536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
WARNING::lambda1_stud not found in config file
WARNING::lambda2_stud not found in config file
2018-05-05 23:31:22.892976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
2018-05-05 23:31:23.000654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: GeForce GTX TITAN X, pci bus id: 0000:04:00.0, compute capability: 5.2)
/users/hzhang2/haowen/miniconda3/envs/py35_tf/lib/python3.5/site-packages/tensorflow/python/ops/gradients_impl.py:96: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
INFO::=================
INFO::episodes: 0
INFO::----step1000----
INFO::hq_ratio: 0.0449
INFO::entropy: 2.188145514288382
INFO::----step2000----
INFO::hq_ratio: 0.0441
INFO::entropy: 1.7450822841699318
INFO::----step3000----
INFO::hq_ratio: 0.045
INFO::entropy: 3.1279462624245062
INFO::----step4000----
INFO::hq_ratio: 0.0335
INFO::entropy: 2.8469871392984536
INFO::----step5000----
INFO::hq_ratio: 0.0386
INFO::entropy: 2.4463291999077565
INFO::----step6000----
INFO::hq_ratio: 0.037
INFO::entropy: 2.1036721193313865
INFO::----step7000----
INFO::hq_ratio: 0.0881
INFO::entropy: 1.3520810800462069
INFO::----step8000----
INFO::hq_ratio: 0.0277
INFO::entropy: 1.0084473085035721
INFO::----step9000----
INFO::hq_ratio: 0.016
INFO::entropy: 1.2419273793057573
INFO::----step10000----
INFO::hq_ratio: 0.0689
INFO::entropy: 1.144370323292658
INFO::----step11000----
INFO::hq_ratio: 0.043
INFO::entropy: 1.2413707195938417
INFO::----step12000----
INFO::hq_ratio: 0.0379
INFO::entropy: 0.24941633595959578
INFO::----step13000----
INFO::hq_ratio: 0.071
INFO::entropy: 2.763535807093397
INFO::----step14000----
INFO::hq_ratio: 0.0948
INFO::entropy: 2.9406097308208996
INFO::----step15000----
INFO::hq_ratio: 0.1345
INFO::entropy: 2.863672431115416
INFO::----step16000----
INFO::hq_ratio: 0.1391
INFO::entropy: 2.674107254794169
INFO::----step17000----
INFO::hq_ratio: 0.1836
INFO::entropy: 2.782689039716819
INFO::----step18000----
INFO::hq_ratio: 0.2017
INFO::entropy: 2.6703694088322325
INFO::----step19000----
INFO::hq_ratio: 0.1801
INFO::entropy: 2.674743018441447
INFO::----step20000----
INFO::hq_ratio: 0.279
INFO::entropy: 2.913714156402146
INFO::----step21000----
INFO::hq_ratio: 0.2988
INFO::entropy: 2.9376778713317795
INFO::----step22000----
INFO::hq_ratio: 0.3101
INFO::entropy: 2.90214612597467
INFO::----step23000----
INFO::hq_ratio: 0.3731
INFO::entropy: 2.9337870012503164
INFO::----step24000----
INFO::hq_ratio: 0.3343
INFO::entropy: 3.0211113585446183
INFO::----step25000----
INFO::hq_ratio: 0.4286
INFO::entropy: 3.0356139347758173
INFO::----step26000----
INFO::hq_ratio: 0.4904
INFO::entropy: 3.055466380154195
INFO::----step27000----
INFO::hq_ratio: 0.5193
INFO::entropy: 3.0965274736862205
INFO::----step28000----
INFO::hq_ratio: 0.5562
INFO::entropy: 3.1178386828519855
INFO::----step29000----
INFO::hq_ratio: 0.5542
INFO::entropy: 3.097401996247269
INFO::----step30000----
INFO::hq_ratio: 0.5777
INFO::entropy: 3.1362294833937687
INFO::----step31000----
INFO::hq_ratio: 0.6293
INFO::entropy: 3.1456103872719727
INFO::----step32000----
INFO::hq_ratio: 0.627
INFO::entropy: 3.1521470066454658
INFO::----step33000----
INFO::hq_ratio: 0.6599
INFO::entropy: 3.179577860861517
INFO::----step34000----
INFO::hq_ratio: 0.5682
INFO::entropy: 3.1144849460008057
INFO::----step35000----
INFO::hq_ratio: 0.5493
INFO::entropy: 3.1409934184691797
INFO::----step36000----
INFO::hq_ratio: 0.7152
INFO::entropy: 3.2010127289792596
INFO::----step37000----
INFO::hq_ratio: 0.7115
INFO::entropy: 3.206054934869468
INFO::----step38000----
INFO::hq_ratio: 0.7471
INFO::entropy: 3.199598008021631
INFO::----step39000----
INFO::hq_ratio: 0.7335
INFO::entropy: 3.2065642508925776
INFO::----step40000----
INFO::hq_ratio: 0.7562
INFO::entropy: 3.199924778676499
INFO::----step41000----
INFO::hq_ratio: 0.7447
INFO::entropy: 3.1940786857678227
INFO::----step42000----
INFO::hq_ratio: 0.7598
INFO::entropy: 3.2094577513426867
INFO::----step43000----
INFO::hq_ratio: 0.7353
INFO::entropy: 3.190510390313692
INFO::----step44000----
INFO::hq_ratio: 0.773
INFO::entropy: 3.2127037595309544
INFO::----step45000----
INFO::hq_ratio: 0.6675
INFO::entropy: 3.1944581201571713
INFO::----step46000----
INFO::hq_ratio: 0.6907
INFO::entropy: 3.188069808282294
INFO::----step47000----
INFO::hq_ratio: 0.7326
INFO::entropy: 3.190355175995548
INFO::----step48000----
INFO::hq_ratio: 0.7972
INFO::entropy: 3.208910983640374
INFO::----step49000----
INFO::hq_ratio: 0.8
INFO::entropy: 3.2059425816070544
INFO::----step50000----
INFO::hq_ratio: 0.7654
INFO::entropy: 3.2047365658466265
INFO::----step51000----
INFO::hq_ratio: 0.7924
INFO::entropy: 3.2042328381670675
INFO::----step52000----
INFO::hq_ratio: 0.7866
INFO::entropy: 3.2105575296768376
INFO::----step53000----
INFO::hq_ratio: 0.7926
INFO::entropy: 3.2070199046549424
INFO::----step54000----
INFO::hq_ratio: 0.8006
INFO::entropy: 3.2143070862020564
INFO::----step55000----
INFO::hq_ratio: 0.7511
INFO::entropy: 3.2028987826210145
INFO::----step56000----
INFO::hq_ratio: 0.7963
INFO::entropy: 3.206281228394052
INFO::----step57000----
INFO::hq_ratio: 0.8114
INFO::entropy: 3.204471435699338
INFO::----step58000----
INFO::hq_ratio: 0.8197
INFO::entropy: 3.2022742196461613
INFO::----step59000----
INFO::hq_ratio: 0.8188
INFO::entropy: 3.2045760224319277
INFO::----step60000----
INFO::hq_ratio: 0.6909
INFO::entropy: 3.171872252302956
INFO::----step61000----
INFO::hq_ratio: 0.8219
INFO::entropy: 3.2050529704989503
INFO::----step62000----
INFO::hq_ratio: 0.7937
INFO::entropy: 3.1920745900173544
INFO::----step63000----
INFO::hq_ratio: 0.8315
INFO::entropy: 3.2057564354050325
INFO::----step64000----
INFO::hq_ratio: 0.7936
INFO::entropy: 3.204881382357211
INFO::----step65000----
INFO::hq_ratio: 0.8105
INFO::entropy: 3.2066961129909
INFO::----step66000----
INFO::hq_ratio: 0.8133
INFO::entropy: 3.206734367647231
INFO::----step67000----
INFO::hq_ratio: 0.805
INFO::entropy: 3.1927414632190834
INFO::----step68000----
INFO::hq_ratio: 0.7708
INFO::entropy: 3.1899918896878603
INFO::----step69000----
INFO::hq_ratio: 0.7764
INFO::entropy: 3.1794487503236746
INFO::----step70000----
INFO::hq_ratio: 0.8173
INFO::entropy: 3.2010687386486865
INFO::----step71000----
INFO::hq_ratio: 0.8187
INFO::entropy: 3.2003578056394653
INFO::----step72000----
INFO::hq_ratio: 0.7964
INFO::entropy: 3.200358573992496
INFO::----step73000----
INFO::hq_ratio: 0.8081
INFO::entropy: 3.2054425315681723
INFO::----step74000----
INFO::hq_ratio: 0.8369
INFO::entropy: 3.203727938940797
INFO::----step75000----
INFO::hq_ratio: 0.8413
INFO::entropy: 3.206441547052894
INFO::----step76000----
INFO::hq_ratio: 0.8206
INFO::entropy: 3.191573286828097
INFO::----step77000----
INFO::hq_ratio: 0.8378
INFO::entropy: 3.200703208215208
INFO::----step78000----
INFO::hq_ratio: 0.8456
INFO::entropy: 3.1980235564314943
INFO::----step79000----
INFO::hq_ratio: 0.8396
INFO::entropy: 3.1995783486919023
INFO::----step80000----
INFO::hq_ratio: 0.8191
INFO::entropy: 3.2013613686562774
INFO::----step81000----
INFO::hq_ratio: 0.8445
INFO::entropy: 3.2036756087185285
INFO::----step82000----
INFO::hq_ratio: 0.8277
INFO::entropy: 3.19777621358912
INFO::----step83000----
INFO::hq_ratio: 0.7538
INFO::entropy: 3.1574910561601945
INFO::----step84000----
INFO::hq_ratio: 0.8298
INFO::entropy: 3.1986512006692513
INFO::----step85000----
INFO::hq_ratio: 0.8122
INFO::entropy: 3.196210853662957
INFO::----step86000----
INFO::hq_ratio: 0.7954
INFO::entropy: 3.1836235518765794
INFO::----step87000----
INFO::hq_ratio: 0.8425
INFO::entropy: 3.203462547801601
INFO::----step88000----
INFO::hq_ratio: 0.8332
INFO::entropy: 3.2007686042184353
INFO::----step89000----
INFO::hq_ratio: 0.8293
INFO::entropy: 3.200132039068477
INFO::----step90000----
INFO::hq_ratio: 0.8435
INFO::entropy: 3.1920500429321894
INFO::----step91000----
INFO::hq_ratio: 0.8491
INFO::entropy: 3.203883839119105
INFO::----step92000----
INFO::hq_ratio: 0.8286
INFO::entropy: 3.1968185414960475
INFO::----step93000----
INFO::hq_ratio: 0.8226
INFO::entropy: 3.1998061296853106
INFO::----step94000----
INFO::hq_ratio: 0.8634
INFO::entropy: 3.200792244792679
INFO::----step95000----
INFO::hq_ratio: 0.8322
INFO::entropy: 3.2008576689523727
INFO::----step96000----
INFO::hq_ratio: 0.8518
INFO::entropy: 3.2033604651168863
INFO::----step97000----
INFO::hq_ratio: 0.8581
INFO::entropy: 3.2031248644890353
INFO::----step98000----
INFO::hq_ratio: 0.8558
INFO::entropy: 3.199107214800266
INFO::----step99000----
INFO::hq_ratio: 0.8575
INFO::entropy: 3.2034614114704767
INFO::----step100000----
INFO::hq_ratio: 0.8378
INFO::entropy: 3.1975512882991377
INFO::----step101000----
INFO::hq_ratio: 0.8428
INFO::entropy: 3.1823487202093586
INFO::----step102000----
INFO::hq_ratio: 0.823
INFO::entropy: 3.1912424785213873
INFO::----step103000----
INFO::hq_ratio: 0.8529
INFO::entropy: 3.194843028348271
INFO::----step104000----
INFO::hq_ratio: 0.8421
INFO::entropy: 3.1997794346732418
INFO::----step105000----
INFO::hq_ratio: 0.8518
INFO::entropy: 3.202606040580244
INFO::----step106000----
INFO::hq_ratio: 0.7776
INFO::entropy: 3.164861851154725
INFO::----step107000----
INFO::hq_ratio: 0.8641
INFO::entropy: 3.2019075077717662
INFO::----step108000----
INFO::hq_ratio: 0.8652
INFO::entropy: 3.203327462768084
INFO::----step109000----
INFO::hq_ratio: 0.8365
INFO::entropy: 3.193999145168489
INFO::----step110000----
INFO::hq_ratio: 0.8546
INFO::entropy: 3.1903586281563316
INFO::----step111000----
INFO::hq_ratio: 0.7936
INFO::entropy: 3.17505240082358
INFO::----step112000----
INFO::hq_ratio: 0.8305
INFO::entropy: 3.2035579775789067
INFO::----step113000----
INFO::hq_ratio: 0.8473
INFO::entropy: 3.1967351802775035
INFO::----step114000----
INFO::hq_ratio: 0.8637
INFO::entropy: 3.1971023095774154
INFO::----step115000----
INFO::hq_ratio: 0.8471
INFO::entropy: 3.198745805366456
INFO::----step116000----
INFO::hq_ratio: 0.8603
INFO::entropy: 3.2005343729694897
INFO::----step117000----
INFO::hq_ratio: 0.8635
INFO::entropy: 3.2047681891955113
INFO::----step118000----
INFO::hq_ratio: 0.8685
INFO::entropy: 3.186197854998896
INFO::----step119000----
INFO::hq_ratio: 0.8419
INFO::entropy: 3.190772059224769
INFO::----step120000----
INFO::hq_ratio: 0.8466
INFO::entropy: 3.200225371135074
INFO::----step121000----
INFO::hq_ratio: 0.7931
INFO::entropy: 3.1840730962052213
INFO::----step122000----
INFO::hq_ratio: 0.837
INFO::entropy: 3.1950810776156193
INFO::----step123000----
INFO::hq_ratio: 0.8666
INFO::entropy: 3.1977881657554414
INFO::----step124000----
INFO::hq_ratio: 0.8232
INFO::entropy: 3.1980695429938657
INFO::----step125000----
INFO::hq_ratio: 0.8517
INFO::entropy: 3.192555077352783
INFO::----step126000----
INFO::hq_ratio: 0.8552
INFO::entropy: 3.2010624297946495
INFO::----step127000----
INFO::hq_ratio: 0.8647
INFO::entropy: 3.1978313376696836
INFO::----step128000----
INFO::hq_ratio: 0.8545
INFO::entropy: 3.1982968647484116
INFO::----step129000----
INFO::hq_ratio: 0.8485
INFO::entropy: 3.201917777333419
INFO::----step130000----
INFO::hq_ratio: 0.7996
INFO::entropy: 3.1757124663658822
INFO::----step131000----
INFO::hq_ratio: 0.8673
INFO::entropy: 3.197334883778072
INFO::----step132000----
INFO::hq_ratio: 0.8703
INFO::entropy: 3.1992655691859775
INFO::----step133000----
INFO::hq_ratio: 0.8455
INFO::entropy: 3.197139579983991
INFO::----step134000----
INFO::hq_ratio: 0.8642
INFO::entropy: 3.1994340533976295
INFO::----step135000----
INFO::hq_ratio: 0.87
INFO::entropy: 3.2022052145449367
INFO::----step136000----
INFO::hq_ratio: 0.8478
INFO::entropy: 3.1933579594406423
INFO::----step137000----
INFO::hq_ratio: 0.8398
INFO::entropy: 3.1948423363380876
INFO::----step138000----
INFO::hq_ratio: 0.847
INFO::entropy: 3.1906658066738816
INFO::----step139000----
INFO::hq_ratio: 0.8646
INFO::entropy: 3.1959803040454537
INFO::----step140000----
INFO::hq_ratio: 0.8559
INFO::entropy: 3.1859634738494296
INFO::----step141000----
INFO::hq_ratio: 0.8539
INFO::entropy: 3.194484552899902
INFO::----step142000----
INFO::hq_ratio: 0.853
INFO::entropy: 3.1905733732972075
INFO::----step143000----
INFO::hq_ratio: 0.8693
INFO::entropy: 3.190919367712403
INFO::----step144000----
INFO::hq_ratio: 0.8657
INFO::entropy: 3.1924031506754407
INFO::----step145000----
INFO::hq_ratio: 0.8586
INFO::entropy: 3.1897626143716815
INFO::----step146000----
INFO::hq_ratio: 0.8752
INFO::entropy: 3.1931050543076873
INFO::----step147000----
INFO::hq_ratio: 0.871
INFO::entropy: 3.1970289149595152
INFO::----step148000----
INFO::hq_ratio: 0.8643
INFO::entropy: 3.192696112695106
INFO::----step149000----
INFO::hq_ratio: 0.8746
INFO::entropy: 3.200422105427913
INFO::----step150000----
INFO::hq_ratio: 0.8797
INFO::entropy: 3.1966854646722056
INFO::----step151000----
INFO::hq_ratio: 0.8799
INFO::entropy: 3.2008486569380135
INFO::----step152000----
INFO::hq_ratio: 0.8711
INFO::entropy: 3.1898728711214943
INFO::----step153000----
INFO::hq_ratio: 0.8632
INFO::entropy: 3.1904961240305423
INFO::----step154000----
INFO::hq_ratio: 0.8763
INFO::entropy: 3.195508008380366
INFO::----step155000----
INFO::hq_ratio: 0.8705
INFO::entropy: 3.1964295720089986
INFO::----step156000----
INFO::hq_ratio: 0.8585
INFO::entropy: 3.197687808614102
INFO::----step157000----
INFO::hq_ratio: 0.8308
INFO::entropy: 3.168001028788173
INFO::----step158000----
INFO::hq_ratio: 0.8739
INFO::entropy: 3.195111599540077
INFO::----step159000----
INFO::hq_ratio: 0.8675
INFO::entropy: 3.194437351811687
INFO::----step160000----
INFO::hq_ratio: 0.8325
INFO::entropy: 3.1817857191229546
INFO::----step161000----
INFO::hq_ratio: 0.8782
INFO::entropy: 3.1903635938493657
INFO::----step162000----
INFO::hq_ratio: 0.8757
INFO::entropy: 3.1856220557738055
INFO::----step163000----
INFO::hq_ratio: 0.8571
INFO::entropy: 3.1894553150026295
INFO::----step164000----
INFO::hq_ratio: 0.874
INFO::entropy: 3.1915821893529697
INFO::----step165000----
INFO::hq_ratio: 0.885
INFO::entropy: 3.1995540631174806
INFO::----step166000----
INFO::hq_ratio: 0.8752
INFO::entropy: 3.1930657507662654
INFO::----step167000----
INFO::hq_ratio: 0.8649
INFO::entropy: 3.1945577682120967
INFO::----step168000----
INFO::hq_ratio: 0.8684
INFO::entropy: 3.1969274202783806
INFO::----step169000----
INFO::hq_ratio: 0.8744
INFO::entropy: 3.2045670963656243
INFO::----step170000----
INFO::hq_ratio: 0.8515
INFO::entropy: 3.1972864019077636
INFO::----step171000----
INFO::hq_ratio: 0.8755
INFO::entropy: 3.200478845951358
INFO::----step172000----
INFO::hq_ratio: 0.8805
INFO::entropy: 3.2014892374163666
INFO::----step173000----
INFO::hq_ratio: 0.8749
INFO::entropy: 3.1908696252463216
INFO::----step174000----
INFO::hq_ratio: 0.8675
INFO::entropy: 3.196152510123779
INFO::----step175000----
INFO::hq_ratio: 0.8165
INFO::entropy: 3.1904184345273814
INFO::----step176000----
INFO::hq_ratio: 0.808
INFO::entropy: 3.182575042445624
INFO::----step177000----
INFO::hq_ratio: 0.8568
INFO::entropy: 3.194151878317601
INFO::----step178000----
INFO::hq_ratio: 0.8807
INFO::entropy: 3.194888933091671
INFO::----step179000----
INFO::hq_ratio: 0.8533
INFO::entropy: 3.183316998244188
INFO::----step180000----
INFO::hq_ratio: 0.8795
INFO::entropy: 3.1894999835392577
INFO::----step181000----
INFO::hq_ratio: 0.8744
INFO::entropy: 3.1891663761604296
INFO::----step182000----
INFO::hq_ratio: 0.8883
INFO::entropy: 3.1935953652288354
INFO::----step183000----
INFO::hq_ratio: 0.8743
INFO::entropy: 3.1928146317312214
INFO::----step184000----
INFO::hq_ratio: 0.8886
INFO::entropy: 3.193539510155728
INFO::----step185000----
INFO::hq_ratio: 0.8655
INFO::entropy: 3.1757255910077316
INFO::----step186000----
INFO::hq_ratio: 0.8719
INFO::entropy: 3.1923812134869505
INFO::----step187000----
INFO::hq_ratio: 0.8864
INFO::entropy: 3.1823171337672895
INFO::----step188000----
INFO::hq_ratio: 0.8651
INFO::entropy: 3.189440004943509
INFO::----step189000----
INFO::hq_ratio: 0.8806
INFO::entropy: 3.191009362602492
INFO::----step190000----
INFO::hq_ratio: 0.8844
INFO::entropy: 3.18922085889742
INFO::----step191000----
INFO::hq_ratio: 0.8741
INFO::entropy: 3.180980937351937
INFO::----step192000----
INFO::hq_ratio: 0.8754
INFO::entropy: 3.1979154389091105
INFO::----step193000----
INFO::hq_ratio: 0.8789
INFO::entropy: 3.200276041986356
INFO::----step194000----
INFO::hq_ratio: 0.8059
INFO::entropy: 3.166335234855259
INFO::----step195000----
INFO::hq_ratio: 0.8911
INFO::entropy: 3.192987154773466
INFO::----step196000----
INFO::hq_ratio: 0.8666
INFO::entropy: 3.1889169196791194
INFO::----step197000----
INFO::hq_ratio: 0.8762
INFO::entropy: 3.1843408572654743
INFO::----step198000----
INFO::hq_ratio: 0.8882
INFO::entropy: 3.176620110991421
INFO::----step199000----
INFO::hq_ratio: 0.8838
INFO::entropy: 3.1689243910701506
INFO::----step200000----
INFO::hq_ratio: 0.8894
INFO::entropy: 3.1910880396352765
load 100000 samples.
load 2000 samples.
Traceback (most recent call last):
  File "trainer.py", line 271, in <module>
    trainer.train()
  File "trainer.py", line 134, in train
    final_reward, adv = model_stud.get_final_reward()
  File "/users/hzhang2/haowen/GitHub/autoLoss/models/gan_grid.py", line 339, in get_final_reward
    reward = self.best_hq_ratio * self.reward_c
AttributeError: 'Gan_grid' object has no attribute 'reward_c'
